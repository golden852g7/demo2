# 团建/活动场地预约平台

本项目提供一个基于 **Node.js + Express** 的后端、**MySQL** 数据库和 **HTML/CSS/JavaScript** 前端的团建/活动场地预约平台，支持用户预约、在线支付（支付宝模拟）、管理员后台管理等功能。

## 功能概览

- 用户体系
  - 用户注册、登录、忘记密码（重置令牌）。
  - 基于 JWT 的身份验证，区分普通用户与系统管理员两类角色。
- 场地管理
  - 管理员可以新增、编辑、删除场地。
  - 场地详情展示、场地可预约时间段查询。
- 预约与支付
  - 用户可以创建场地预约，系统会自动校验时间段冲突。
  - 支持支付宝支付流程模拟，支付成功后自动锁定场地。
  - 预约结束或被管理员取消后，场地自动恢复可预约状态。
- 订单管理
  - 管理员可以查看所有预约、手动完成或取消订单。
  - 用户可以查看自己的预约记录、取消未开始的预约。
- 前端页面
  - 登录、注册、忘记密码页面。
  - 用户端主页：浏览场地、预约、查看订单与支付状态。
  - 管理端控制台：场地管理、预约管理、用户概览。
  - 设计遵循大厂风格的现代化布局与配色。

## 快速开始

### 1. 环境准备

- Node.js >= 18
- npm 或 yarn
- MySQL 8.x（或兼容版本）

### 2. 克隆与安装

```bash
# 安装后端依赖
cd backend
npm install
```

### 3. 数据库配置

1. 创建数据库，例如 `team_building`。
2. 复制 `.env.example` 为 `.env`，并填入数据库连接信息、JWT 密钥等。

```bash
cd backend
cp .env.example .env
# 编辑 .env 设置 MYSQL_*、JWT_SECRET 等参数
```

3. 运行数据库迁移与基础数据初始化脚本：

```bash
npm run db:migrate
npm run db:seed
```

### 4. 启动后端服务

```bash
npm run dev
```

服务默认运行在 `http://localhost:3000`。

### 5. 启动前端静态资源

后端已经配置了静态资源托管，启动后访问 `http://localhost:3000` 即可进入前端页面。

如需本地开发前端，可直接在 `frontend` 目录使用任意静态服务器（例如 `npx serve`）。

### 6. 运行测试

```bash
npm test
```

> 当前仅提供基础的 API 单元测试示例，可根据需要补充。

## 目录结构规划

```
.
├── README.md
├── backend
│   ├── package.json
│   ├── .env.example
│   ├── src
│   │   ├── app.js              # Express 应用入口
│   │   ├── server.js           # 启动脚本
│   │   ├── config              # 配置（数据库、JWT 等）
│   │   ├── database            # Sequelize 初始化、模型、迁移、种子数据
│   │   ├── middlewares         # 鉴权、错误处理等
│   │   ├── controllers         # 业务控制器
│   │   ├── routes              # 路由定义
│   │   ├── services            # 业务逻辑层
│   │   └── utils               # 工具函数
├── frontend
│   ├── index.html              # 用户端入口
│   ├── admin.html              # 管理员控制台
│   ├── auth.html               # 登录/注册/忘记密码
│   ├── assets
│   │   ├── css
│   │   │   └── styles.css
│   │   └── js
│   │       ├── api.js         # 封装请求
│   │       ├── auth.js        # 登录注册逻辑
│   │       ├── user.js        # 用户端逻辑
│   │       └── admin.js       # 管理端逻辑
└── ...
```

## 迭代步骤建议

1. **初始化项目结构**：创建 `backend`、`frontend` 目录及基础文件。
2. **配置数据库模型**：定义用户、场地、预约、支付模型与关联。
3. **实现鉴权模块**：注册、登录、JWT 中间件、角色权限控制。
4. **完成场地管理 API**：增删改查、可用性校验逻辑。
5. **完成预约与支付流程**：预约创建、支付模拟、订单状态机。
6. **实现前端页面**：按照设计完成用户端与管理端页面交互。
7. **编写测试与文档**：补充 API 测试、完善 README 与部署说明。

## 部署建议

- 推荐将后端部署在云服务器，前端静态资源放置在 CDN 或 Nginx。
- 使用 `pm2` 等进程管理工具保证 Node.js 服务稳定。
- 配置 HTTPS 与真实的支付宝支付接口时，需要申请并配置相关密钥。

## 许可证

本项目可自由用于商业用途，请根据实际情况在生产环境中完善安全加固与支付集成。
